<%- include('includes/header')  %>

<div class="container py-md-5 container--narrow">
  <%- include("includes/flash") %>
  
  <div class="mt-2 pt-2 mb-3 text-center">
    <% if (items.length > 0) { %>
      <h4>Hello <strong><%= profileUsername.charAt(0).toUpperCase() + profileUsername.slice(1) %></strong>. You currently have <%= items.length %>
        <% if(items.length == 1) { %>
          item in your list.</h4>
        <% } else { %>
          items in your list.</h4>
        <% } %>
    <% } else { %>
      <h4>Hello <strong><%= profileUsername.charAt(0).toUpperCase() + profileUsername.slice(1) %></strong>.<br> </h4><h4 class="lead text-muted"><a style="text-decoration: none" href="/create-item"><strong>Add a Car</strong></a> to your list to get started.</h4>
      <% } %>
  </div>

  <div class="list-group">
   <% items.forEach(function(item) { %>
    <div class="card mb-4">
    <span class="list-group-item list-group-item-primary">
      <strong><%= item.description %></strong>

      <!-- Conditional Link Icon Code Here -->
      <% if (item.link == "") { %>
      <% } else { %>
        <a href="<%= item.link %>" target="_blank" class="text-primary mr-2" data-toggle="tooltip" data-placement="top" title="Link To Listing"><i class="ml-2 fas fa-external-link-alt"></i></a>
      <% } %><!-- Conditional Link Icon Code End -->

      <!-- opens edit and delete span floated right here -->
      <span class="float-right">
        <!-- edit icon -->
        <a href="/item/<%= item._id %>/edit" class="text-primary mr-2" data-toggle="tooltip" data-placement="top" title="Edit"><i class="fas fa-edit"></i></a>

        <!-- delete icon form button starts here -->
        <form class="delete-post-form d-inline" action="/item/<%= item._id %>/delete" method="POST">
          <!-- protects against csrf attack -->
          <input type="hidden" name="_csrf" value="<%= csrfToken %>" >
          <!-- Actual button -->
          <button class="delete-post-button text-danger" data-toggle="tooltip" data-placement="top" title="Delete"><i class="fas fa-trash"></i></button>
        </form><!-- form button ends here -->
      </span><!-- closes edit and delete span floated right here -->

    </span>
   
    
    <span class="list-group-item list-group-flush">Cost: $<%= item.cost.toLocaleString("en-US") %></span>
    <span class="list-group-item list-group-flush">Miles: <%= item.miles.toLocaleString("en-US") %></span>
    <span class="list-group-item list-group-flush">Remaining Months: <%= item.remaining_months %></span>
    <span class="list-group-item list-group-flush">Cost Per Remaining Months: $<%= item.cost_per_remaining_month %></span>
    
      
    
  </div>
   <% }) %>
  </div>
</div>

<div class="mt-1 pt-2 mb-5 text-center">
  <p class="text-muted small">Edit your <a href="#">Settings</a> or <a href="/learn-more">learn more</a> about "Remaining Months" and "Cost per Remaining Month."</p>
</div>

<%- include('includes/footer')  %>